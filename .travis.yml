language: python
python:
- '3.6'
os:
- linux
env:
  global:
  - TX_BRANCH="master"
install:
- pip install --upgrade pip setuptools wheel
- pip install -r requirements.txt
- pip install coveralls codecov codacy-coverage
- pip install transifex-client sphinx sphinx-intl
- python setup.py sdist bdist_wheel
- pip install tradssat --no-index --find-links=./dist
script:
- cd tests
- coverage run -m unittest
after_success:
- coveralls --rcfile=.coveragerc
- codecov
- coverage xml
- python-codacy-coverage -r coverage.xml
- cd ..
- cd docs
- if [[ $TRAVIS_PULL_REQUEST == "false" ]]; then sh .tx/tx.sh push; sh .tx/tx.sh pull;
  fi
- cd ..
deploy:
  provider: pypi
  user: julien.malard
  password:
    secure: coTyPdqEe/ctlKIQlfGyrLiTxefCve1E5Q4Hu+LObMQzNwSEwlnoM8ybuSuHSkhz8xx56iHVsKlqkZzTw5nn+jDaVVbhuRBRq4StZoX9kT4Y/F4dCQ/eLKpKSwawzaPi4WMBt/Q3bPyDWKLKgKUkJL5fskxTs4P2mCAqorTN4yHq1+Eq+zf9LKXkQc+W4NghXu/G/AncJ3vALi0y8kk3/hS4rTVamgfPQ3n/pFcWd0Mu7fEpzJB0u/6kGfZie0xr57PcxQ8xbdoUFuGwwxPiW7FVABZ972bZRy8OEQYwXnTQQtu5dS932hwkqrZ+P30fUvb2qWVFe+5sa9Mx6pyZK3EyGkq6IWAHc2aDR8dMDMa3jrKr9APJVHx51k+45pRDe3213Yns3KkfUxjZYhypeSHER5uwFZIUdr0KDgyxRZAPplQqfm9z/lFo+2hiGeQfUoVj5aluOnAVYvIkFO28pMcBaY7zoLCtvCzmKHoBcVvn0Rmj0cx4RXvwp1IqSqTZHeW3nEhOsCLRsVZx7OcrZQSGVkDPu6oKDN5NFGwqIu638Ur3SZsVXPWgBicyhfju9gu8WElOy2o2GZJSwFQ4YlE7XXVPba8y89JC/i4TxU6cau9uEW4ux8yL/yTEt4ChF2xnJtA/lgURsnHcJWP0Xt0mkfLd7ti/IVikcUrCV6s=
  distributions: sdist bdist_wheel
  skip_existing: true
  on:
    tags: true
